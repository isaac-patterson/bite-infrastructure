---
AWSTemplateFormatVersion: '2010-09-09'
Description: ECR and other misc resources 

Parameters:
  StackName:
    Description: An Application name that will be prefixed to resource names
    Type: String
    Default: misc-stack
  Stage:
    Type: String
    
Resources:
  ECRRepository: 
    Type: AWS::ECR::Repository
    Properties: 
      RepositoryName: veni-ecr
      RepositoryPolicyText: 
        Version: "2012-10-17"
        Statement: 
          - Effect: Allow
            Principal:
              Service: codebuild.amazonaws.com
            Action: 'sts:AssumeRole' 

Outputs:
  ECRRepository:
    Description: Private subnet routetable one
    Value: !Ref 'ECRRepository'
    Export:
      Name: !Join [ '-', [ !Ref 'AWS::StackName', 'ECRRepository'] ]

  ECRURL:
    Description: URL to ecr repo
    Value:                 
      !Join ['', [!Ref AWS::AccountId, '.dkr.ecr.', !Ref AWS::Region, '.amazonaws.com/veni-ecr/']]
